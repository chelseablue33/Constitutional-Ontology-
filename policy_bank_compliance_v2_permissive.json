{
  "policy_id": "bank_compliance_drafting_agent_v2_permissive",
  "policy_version": "2.0.0-permissive",
  "created": "2024-12-20",
  "description": "More permissive configuration: higher autonomy, more tools, inter-agent enabled",
  
  "dials": {
    "autonomy": {
      "level": "L3",
      "label": "act_autonomously",
      "description": "Agent can act autonomously for most actions; approval only for critical operations"
    },
    "tool_access": {
      "level": "L3", 
      "label": "write_autonomous",
      "description": "Agent can write to draft and approved destinations autonomously"
    },
    "personalization": {
      "level": "L4",
      "label": "org_wide_profiling",
      "description": "Organization-wide preferences and profiling allowed"
    },
    "memory": {
      "level": "L4",
      "label": "persistent_org_shared",
      "description": "Persistent memory with org-wide sharing; user view/edit/delete"
    },
    "inter_agent": {
      "level": "L2",
      "label": "restricted_communication",
      "description": "Inter-agent communication permitted with approval"
    }
  },

  "gates": {
    "S-I": {
      "name": "System Inbound",
      "direction": "system_to_agent",
      "allow": [
        "receive_sharepoint_docs",
        "receive_occ_fdic_text",
        "receive_external_apis",
        "receive_database_queries",
        "receive_email_attachments"
      ],
      "controls": [
        {
          "type": "provenance_required",
          "params": {"capture": ["source_uri", "doc_hash", "retrieval_timestamp"]}
        },
        {"type": "malware_scan"},
        {"type": "log", "params": {"events": ["retrieval_event", "query"]}}
      ],
      "deny": [
        "files_with_executables"
      ]
    },

    "S-O": {
      "name": "System Outbound",
      "direction": "agent_to_system",
      "allow": [
        {"action": "read", "target": "sharepoint"},
        {"action": "read", "target": "occ_fdic_db"},
        {"action": "read", "target": "external_apis"},
        {"action": "write", "target": "draft_doc", "controls": ["log"]},
        {"action": "write", "target": "approved_doc", "controls": ["log", "versioning"]},
        {"action": "execute", "target": "jira_create_task", "controls": ["approval_hitl", "log"]},
        {"action": "execute", "target": "email_send", "controls": ["log", "approval_hitl"]},
        {"action": "execute", "target": "slack_notify", "controls": ["log"]}
      ],
      "controls": [
        {"type": "least_privilege", "params": {"scope_to_tool_allowlist": true}},
        {"type": "log", "params": {"capture": ["tool_call", "params", "result"]}}
      ],
      "deny": [
        "publish_external_without_approval",
        "execute_beyond_allowlist"
      ]
    },

    "U-I": {
      "name": "User Inbound", 
      "direction": "user_to_agent",
      "allow": [
        "receive_instructions",
        "receive_feedback",
        "receive_edits",
        "receive_bulk_requests"
      ],
      "controls": [
        {"type": "auth", "params": {"method": "sso", "session_binding": true}},
        {"type": "injection_detect", "params": {"scan_pasted_text": true}},
        {"type": "log", "params": {"capture": ["user_id", "request_type", "timestamp"]}}
      ],
      "deny": [
        "request_export_external_without_approval"
      ]
    },

    "U-O": {
      "name": "User Outbound",
      "direction": "agent_to_user", 
      "allow": [
        "present_drafts",
        "ask_clarifying_questions",
        "show_citations",
        "notify_task_created",
        "present_analytics"
      ],
      "controls": [
        {"type": "provenance_required", "params": {"apply_to": "regulatory_claims"}},
        {"type": "no_deception", "params": {"disclose_limitations": true}},
        {"type": "log", "params": {"capture": ["response", "citations"]}}
      ],
      "deny": [
        "share_to_external_recipients_without_approval",
        "claims_without_citations"
      ]
    },

    "M-I": {
      "name": "Memory Inbound",
      "direction": "memory_to_agent",
      "allow": [
        "retrieve_writing_style",
        "retrieve_citation_format", 
        "retrieve_templates",
        "retrieve_org_preferences",
        "retrieve_shared_knowledge"
      ],
      "controls": [
        {"type": "data_minimization"},
        {"type": "acl", "params": {"scope": "org_wide"}},
        {"type": "log", "params": {"capture": ["what_retrieved"]}},
        {"type": "versioning", "params": {"track_template_provenance": true}}
      ],
      "deny": [
        "retrieve_regulated_data"
      ]
    },

    "M-O": {
      "name": "Memory Outbound",
      "direction": "agent_to_memory",
      "allow": [
        "store_citation_format",
        "store_templates",
        "store_style_prefs",
        "store_org_knowledge",
        "store_workflow_patterns"
      ],
      "controls": [
        {"type": "user_controls", "params": {"allow": ["view", "edit", "delete"]}},
        {"type": "retention_policy", "params": {"max_days": 730, "review_required": false}},
        {"type": "encryption", "params": {"at_rest": true}},
        {"type": "log"}
      ],
      "deny": [
        "store_pii",
        "store_phi", 
        "store_customer_account_info"
      ]
    },

    "A-I": {
      "name": "Agent Inbound",
      "direction": "other_agent_to_agent",
      "allow": [
        {"action": "receive_query", "from": "research_agent", "controls": ["approval_hitl"]},
        {"action": "receive_data", "from": "data_agent", "controls": ["provenance_required"]}
      ],
      "controls": [
        {"type": "auth", "params": {"method": "agent_certificate"}},
        {"type": "log", "params": {"capture": ["source_agent", "payload_type"]}}
      ],
      "deny": [
        "receive_from_untrusted_agents",
        "receive_executable_code"
      ]
    },

    "A-O": {
      "name": "Agent Outbound", 
      "direction": "agent_to_other_agent",
      "allow": [
        {"action": "send_query", "to": "research_agent", "controls": ["approval_hitl"]},
        {"action": "send_data", "to": "data_agent", "controls": ["provenance_required"]}
      ],
      "controls": [
        {"type": "auth", "params": {"method": "agent_certificate"}},
        {"type": "log", "params": {"capture": ["target_agent", "payload_type"]}}
      ],
      "deny": [
        "send_to_untrusted_agents",
        "send_executable_code"
      ]
    }
  },

  "overlays_enabled": ["OCC_MRM_v0"],

  "overlays": {
    "OCC_MRM_v0": {
      "name": "OCC Model Risk Management",
      "version": "0.1",
      "constraints": [
        {
          "trigger": {"gate": "S-O", "action": "execute", "target": "email_send"},
          "add_controls": ["approval_hitl", "change_ticket_id_required"],
          "evidence": ["approval_record", "ticket_id"]
        },
        {
          "trigger": {"gate": "U-O", "content_type": "regulatory_reference"},
          "add_controls": ["provenance_required"],
          "evidence": ["source_citation", "retrieval_timestamp"]
        }
      ]
    },

    "EU_AIACT_HR_v0": {
      "name": "EU AI Act High-Risk",
      "version": "0.1",
      "enabled": false,
      "constraints": [
        {
          "trigger": {"gate": "U-O"},
          "add_controls": ["instructions_for_use", "limitations_disclosure"],
          "evidence": ["disclosure_attached"]
        }
      ]
    }
  },

  "constitutional_pillars": {
    "dignity": {
      "gates": ["U-O", "U-I", "M-O"],
      "validation_rules": [
        "If User + Regulated Data + Write/Share → require Consent + Redaction + Logging",
        "No deception: must disclose agent identity and limitations"
      ]
    },
    "hope": {
      "gates": ["S-I", "A-I", "M-I"],
      "validation_rules": [
        "If consequential claims → require ProvenanceRequired",
        "Sources must be cited"
      ]
    },
    "agency": {
      "gates": ["S-O", "A-O"],
      "validation_rules": [
        "If Execute or Delegate → require Approval or HITL based on risk tier",
        "User can revoke permissions at any time"
      ]
    }
  },

  "enforcement_hooks": {
    "pre_tool_call": {
      "gate": "S-O",
      "checks": ["least_privilege", "approval_hitl", "scope_validation", "allowlist_check"]
    },
    "post_tool_result": {
      "gate": "S-I", 
      "checks": ["provenance_required", "malware_scan", "injection_scrub"]
    },
    "pre_response": {
      "gate": "U-O",
      "checks": ["provenance_required", "no_deception", "log"]
    },
    "post_user_input": {
      "gate": "U-I",
      "checks": ["auth_validation", "injection_detection", "log"]
    },
    "memory_write": {
      "gate": "M-O",
      "checks": ["redaction", "retention_policy", "encryption"]
    },
    "memory_read": {
      "gate": "M-I",
      "checks": ["acl", "data_minimization", "versioning_check"]
    },
    "agent_communication": {
      "gate": ["A-I", "A-O"],
      "checks": ["auth_validation", "approval_hitl", "provenance_required"]
    }
  }
}

